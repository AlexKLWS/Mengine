set( MY_LIB_NAME SDLApplication )

ADD_FILTER(
src
    main.cpp
    SDLApplication.cpp
    SDLApplication.h
    SDLMessageBoxLogger.cpp
    SDLMessageBoxLogger.h
)

add_definitions(-DUNICODE)
add_definitions(-D_UNICODE)

INCLUDE_DIRECTORIES( 
    ${Mengine_SOURCE_DIR}/Utils
    ${THIRDPARTY_DIR}/pybind/include
    ${THIRDPARTY_DIR}/pybind/include
    ${THIRDPARTY_DIR}/SDL2/include
    ${THIRDPARTY_DIR}/SDL2_net
    ${THIRDPARTY_DIR}/SDL2_mixer
)

#MESSAGE( CMAKE_ARCHIVE_OUTPUT_DIRECTORY = "${CMAKE_ARCHIVE_OUTPUT_DIRECTORY}" )
LINK_DIRECTORIES( ${CMAKE_ARCHIVE_OUTPUT_DIRECTORY} )

if(WIN32)
ADD_EXECUTABLE( ${MY_LIB_NAME} WIN32 ${SRC_FILES} )
endif()

if(APPLE)
ADD_EXECUTABLE( ${MY_LIB_NAME} MACOSX_BUNDLE ${SRC_FILES} )
endif()

if (WIN32) #disable console mode for VC++
	set_target_properties( ${MY_LIB_NAME} PROPERTIES WIN32_EXECUTABLE TRUE)
endif(WIN32)

foreach(dependency ${APPLICATION_DEPENDENCIES})
	#MESSAGE( ${LIB_PREFIX}${dependency}${MENGINE_LIB_SUFFIX} )
	TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} debug ${dependency} )
	TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} optimized ${dependency} )
endforeach(dependency ${APPLICATION_DEPENDENCIES})

TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}SDL2${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}SDL2main${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}SDL2_net${MENGINE_LIB_SUFFIX})
TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} ${THIRDPARTY_LIB_DIR}/${MENGINE_LIB_PREFIX}SDL2_mixer${MENGINE_LIB_SUFFIX})

TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} ${APPLICATION_LIBS} )

if(APPLE)
INCLUDE_DIRECTORIES ( /System/Library/Frameworks )

FIND_LIBRARY(Cocoa_LIBRARY Cocoa)
FIND_LIBRARY(Carbon_LIBRARY Carbon)
FIND_LIBRARY(AppKit_LIBRARY AppKit )
FIND_LIBRARY(CoreData_LIBRARY CoreData )
FIND_LIBRARY(CoreAudio_LIBRARY CoreAudio )
FIND_LIBRARY(CoreVideo_LIBRARY CoreVideo )
FIND_LIBRARY(CoreFoundation_LIBRARY CoreFoundation )
FIND_LIBRARY(AudioToolBox_LIBRARY AudioToolBox)
FIND_LIBRARY(IOKit_LIBRARY IOKit )
FIND_LIBRARY(ForceFeedback_LIBRARY ForceFeedback )
FIND_LIBRARY(Foundation_LIBRARY Foundation )
FIND_LIBRARY(OpenGL_LIBRARY OpenGL )

MARK_AS_ADVANCED (Cocoa_LIBRARY
		 Carbon_LIBRARY
                 AppKit_LIBRARY
                 CoreData_LIBRARY
		 CoreAudio_LIBRARY
		 CoreFoundation_LIBRARY
		 AudioToolBox_LIBRARY
		 IOKit_LIBRARY
                 ForceFeedback_LIBRARY
		 CoreVideo_LIBRARY
                 Foundation_LIBRARY
                 OpenGL_LIBRARY)

SET(EXTRA_LIBS ${Cocoa_LIBRARY} ${Carbon_LIBRARY} ${AppKit_LIBRARY} ${CoreData_LIBRARY} ${CoreAudio_LIBRARY} ${CoreFoundation_LIBRARY} ${ForceFeedback_LIBRARY} ${IOKit_LIBRARY} ${CoreVideo_LIBRARY} ${AudioToolBox_LIBRARY} ${Foundation_LIBRARY} ${OpenGL_LIBRARY} ${OpenAL_LIBRARY})

TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} ${EXTRA_LIBS})
TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} iconv)
endif()

if(WIN32)
TARGET_LINK_LIBRARIES( ${MY_LIB_NAME} Winmm Version Imm32 OpenGL32) 
endif()

if(MSVC)
    set_target_properties( ${MY_LIB_NAME} PROPERTIES LINK_FLAGS /FORCE:MULTIPLE )
endif(MSVC)
